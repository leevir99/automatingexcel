Sub FillFieldWithModifiedValue()
    Dim excelApp As Object ' Excel.Application
    Dim excelWorkbook As Object ' Excel.Workbook
    Dim excelWorksheet As Object ' Excel.Worksheet
    Dim value As String
    Dim modifiedValue As String
    
    ' Check if an Excel instance is already open
    On Error Resume Next
    Set excelApp = GetObject(, "Excel.Application")
    On Error GoTo 0
    
    ' If no open instance is found, create a new one
    If excelApp Is Nothing Then
        Set excelApp = CreateObject("Excel.Application")
    End If
    
    ' Set the workbook and worksheet
    Set excelWorkbook = excelApp.Workbooks("MML-kululaskuri.xlsm")
    Set excelWorksheet = excelWorkbook.Worksheets(1)
    
    ' Get the value from cell D65 in Excel
    value = excelWorksheet.Range("D65").Value
    
    ' Trim the value and remove the Euro symbol
    modifiedValue = Trim(Replace(value, "â‚¬", ""))
    
    ' Fill the "Teksti46" field in Word with the modified value
    ActiveDocument.FormFields("Teksti46").Result = modifiedValue
    
    ' Clean up objects
    Set excelWorksheet = Nothing
    Set excelWorkbook = Nothing
    Set excelApp = Nothing
End Sub
