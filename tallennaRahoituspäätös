Sub tallennaRahoituspaatos()
    Dim pdfApp As Object
    Dim savePath As String
    Dim fileName As String
    Dim hankenumero As String
    
    ' Check if hankenumero is empty
    hankenumero = Range("B40").Value
    If Len(hankenumero) = 0 Then
        MsgBox "Hankenumero puuttuu solusta B40", vbExclamation, "Virhe"
        Exit Sub
    End If
    
    ' Ask the user to activate the desired PDF
    MsgBox "Aseta PDF-XChange Editor -ohjelmassa rahoituspäätös aktiiviseksi/näkyville ja paina sen jälkeen OK.", vbInformation, "Ohje"
    
    ' Set the save path and file name
    savePath = Range("E28").Value
    fileName = "Rahoituspäätös"
    
    ' Create PDF application object
    Set pdfApp = CreateObject("Shell.Application")
    
    ' Check if PDF application is running
    If pdfApp Is Nothing Then
        MsgBox "PDF-XChange Editor -ohjelma ei ole käynnissä.", vbExclamation, "Virhe"
        Exit Sub
    End If
    
    ' Activate the PDF-XChange Editor window
    pdfApp.Open savePath & "\" & fileName & ".pdf"
    
    ' Wait for the user to save the PDF and click OK
    MsgBox "Kun olet tallentanut PDF:n PDF-XChange Editor -ohjelmassa, paina OK.", vbInformation, "Ohje"
    
    ' Display a success message
    MsgBox "PDF tallennettu onnistuneesti.", vbInformation, "Tallennus"
End Sub
