Sub tiedotToimeksiantosopimukselle()
    Dim excelApp As Object ' Excel.Application
    Dim excelWorkbook As Object ' Excel.Workbook
    Dim excelWorksheet As Object ' Excel.Worksheet
    Dim valueG10 As String
    Dim valueG11 As String
    Dim person1Name As String
    Dim person2Name As String
    Dim person1ID As String
    Dim person2ID As String
    
    ' Check if an Excel instance is already open
    On Error Resume Next
    Set excelApp = GetObject(, "Excel.Application")
    On Error GoTo 0
    
    ' If no open instance is found, create a new one
    If excelApp Is Nothing Then
        Set excelApp = CreateObject("Excel.Application")
    End If
    
    ' Set the workbook and worksheet
    Set excelWorkbook = excelApp.Workbooks("MML-kululaskuri.xlsm")
    Set excelWorksheet = excelWorkbook.Worksheets(1)
    
    ' Get the values from cells G10 and G11 in Excel
    valueG10 = excelWorksheet.Range("G10").Value
    valueG11 = excelWorksheet.Range("G11").Value
    
    ' Extract person 1 name and ID
    Dim person1Details() As String
    person1Details = Split(valueG10, ", ")
    person1Name = Trim(person1Details(0))
    person1ID = Trim(person1Details(1))
    
    ' Extract person 2 name and ID if G11 is not empty
    If valueG11 <> "" Then
        Dim person2Details() As String
        person2Details = Split(valueG11, ", ")
        person2Name = Trim(person2Details(0))
        person2ID = Trim(person2Details(1))
    End If
    
    ' Fill the "Teksti35" field in Word with person names
    If valueG11 <> "" Then
        ActiveDocument.FormFields("Teksti35").Result = person1Name & ", " & person2Name
    Else
        ActiveDocument.FormFields("Teksti35").Result = person1Name
    End If
    
    ' Fill the "Teksti36" field in Word with person IDs
    If valueG11 <> "" Then
        ActiveDocument.FormFields("Teksti36").Result = person1ID & " / " & person2ID
    Else
        ActiveDocument.FormFields("Teksti36").Result = person1ID
    End If
    
    ' Clean up objects
    Set excelWorksheet = Nothing
    Set excelWorkbook = Nothing
    Set excelApp = Nothing
End Sub
