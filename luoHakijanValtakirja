Sub luoHakijanValtakirja()
    ' Define the source file path
    Dim sourceFilePath As String
    sourceFilePath = "Z:\1.ASIAKIRJALAADINTA\Luojan ty√∂kalut\Pohjat\Hakijan valtakirja.docx"
    
    ' Define the destination folder path from cell E28
    Dim destinationFolderPath As String
    destinationFolderPath = Range("E28").Value
    
    ' Check if the destination folder path is empty
    If destinationFolderPath = "" Then
        MsgBox "Destination folder path is not specified. Please enter the folder path in cell E28.", vbCritical
        Exit Sub
    End If
    
    ' Check if the destination folder exists
    If Dir(destinationFolderPath, vbDirectory) = "" Then
        MsgBox "Destination folder does not exist. Please enter a valid folder path in cell E28.", vbCritical
        Exit Sub
    End If
    
    ' Define the destination file path with the original file name
    Dim destinationFilePath As String
    destinationFilePath = destinationFolderPath & "\" & "Hakijan valtakirja.docx"
    
    ' Check if the file with the same name already exists in the destination folder
    If Dir(destinationFilePath) <> "" Then
        MsgBox "A file with the same name already exists in the destination folder. Opening the existing file.", vbInformation
        
        ' Open the existing file using the CreateObject function
        Dim wordApp As Object
        Set wordApp = CreateObject("Word.Application")
        wordApp.Visible = True
        wordApp.Documents.Open destinationFilePath
    Else
        ' Copy the source file to the destination folder
        FileCopy sourceFilePath, destinationFilePath
        
        ' Open the copied file using the CreateObject function
        Dim wordApp As Object
        Set wordApp = CreateObject("Word.Application")
        wordApp.Visible = True
        wordApp.Documents.Open destinationFilePath
    End If
    
    ' Display the actual file path being used
    MsgBox "Destination file path: " & destinationFilePath, vbInformation
End Sub
