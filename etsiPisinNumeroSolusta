Sub etsiPisinNumeroSolusta()
    Dim solu As Range
    Dim maksimimerkit As Integer
    Dim pisinNumero As String
    Dim numeroLoydetty As Boolean
    
    ' Aseta syöterange
    Set solu = Range("A5")
    
    ' Tarkista, onko solussa mitään numeroita
    If WorksheetFunction.Count(solu) = 0 Then Exit Sub
    
    ' Alusta muuttujat
    maksimimerkit = 0
    pisinNumero = ""
    numeroLoydetty = False
    
    ' Etsi pisin numero solussa
    Dim sanat() As String
    sanat = Split(solu.Value, " ")
    
    Dim i As Integer
    For i = LBound(sanat) To UBound(sanat)
        If IsNumeric(sanat(i)) Then
            If Len(sanat(i)) > maksimimerkit Then
                maksimimerkit = Len(sanat(i))
                pisinNumero = sanat(i)
                numeroLoydetty = True
            End If
        End If
    Next i
    
    ' Kirjoita pisin numero soluun B40, jos numero on löydetty
    If numeroLoydetty Then
        Range("B40").Value = pisinNumero
    End If
End Sub
