Sub UpdateDataFromPDF()
    Dim pdfText As String
    Dim lines As Variant
    Dim rpSheet As Worksheet
    Dim startCell As Range
    Dim ratkaisuehdotusCell As Range
    Dim hakijatCell As Range
    Dim luototussuhdeCell As Range
    
    ' Set the worksheet variables
    Set rpSheet = ThisWorkbook.Sheets("rp")
    
    ' Prompt the user to copy the contents of the PDF file
    MsgBox "Please copy the entire text content of the PDF file and click OK when ready."
    
    ' Clear the entire "rp" sheet
    rpSheet.Cells.Clear
    
    ' Retrieve the copied text from the clipboard
    pdfText = GetClipboardText()
    
    ' Split the text into lines
    lines = Split(pdfText, vbCrLf)
    
    ' Specify the starting cell for inserting the PDF text (change A1 to the desired cell reference)
    Set startCell = rpSheet.Range("A1")
    
    ' Insert the PDF text into the "rp" sheet starting from cell A1
    startCell.Resize(UBound(lines) + 1).Value = Application.Transpose(lines)
    
    ' Find the ratkaisuehdotus cell
    Set ratkaisuehdotusCell = rpSheet.Cells.Find("Ratkaisuehdotus", LookIn:=xlValues, LookAt:=xlWhole)
    
    ' Find the hakijat cell
    Set hakijatCell = rpSheet.Cells.Find("Hakijat", LookIn:=xlValues, LookAt:=xlWhole, After:=ratkaisuehdotusCell)
    
    ' Find the luototussuhde value between ratkaisuehdotus and hakijat cells
    If Not ratkaisuehdotusCell Is Nothing And Not hakijatCell Is Nothing Then
        Set luototussuhdeCell = rpSheet.Range(ratkaisuehdotusCell.Offset(1), hakijatCell.Offset(-1)).Find("Luototussuhde", LookIn:=xlValues, LookAt:=xlPart)
    End If
    
    ' Check if luototussuhde value exists
    If Not luototussuhdeCell Is Nothing Then
        Dim luototussuhdeValue As String
        luototussuhdeValue = ExtractNumberFromString(luototussuhdeCell.Value)
        
        ' Update cell B82 in the "Main" sheet with luototussuhde value
        ThisWorkbook.Sheets("Main").Range("B82").Value = "Luototussuhde " & luototussuhdeValue & " %"
    End If
End Sub

Function GetClipboardText() As String
    Dim dataObj As MSForms.DataObject
    
    Set dataObj = New MSForms.DataObject
    dataObj.GetFromClipboard
    GetClipboardText = dataObj.GetText
End Function

Function ExtractNumberFromString(text As String) As String
    Dim num As String
    Dim i As Integer
    For i = 1 To Len(text)
        If IsNumeric(Mid(text, i, 1)) Or Mid(text, i, 1) = "," Then
            num = num & Mid(text, i, 1)
        End If
    Next i
    ExtractNumberFromString = num
End Function
