Sub FillFieldsWithModifiedValues()
    Dim excelApp As Object ' Excel.Application
    Dim excelWorkbook As Object ' Excel.Workbook
    Dim excelWorksheet As Object ' Excel.Worksheet
    Dim valueD32 As String
    Dim valueD1 As String
    Dim valueD50 As Double
    Dim valueD60 As Double
    Dim valueD64 As Double
    Dim modifiedValueD32 As String
    Dim modifiedValueD1 As String
    Dim sumValue As Double
    
    ' Check if an Excel instance is already open
    On Error Resume Next
    Set excelApp = GetObject(, "Excel.Application")
    On Error GoTo 0
    
    ' If no open instance is found, create a new one
    If excelApp Is Nothing Then
        Set excelApp = CreateObject("Excel.Application")
    End If
    
    ' Set the workbook and worksheet
    Set excelWorkbook = excelApp.Workbooks("MML-kululaskuri.xlsm")
    Set excelWorksheet = excelWorkbook.Worksheets(1)
    
    ' Get the value from cell D32 in Excel
    valueD32 = excelWorksheet.Range("D32").Value
    
    ' Trim the value from cell D32 and remove the Euro symbol
    modifiedValueD32 = Trim(Replace(valueD32, "€", ""))
    
    ' Fill the "Teksti45" field in Word with the modified value from D32
    ActiveDocument.FormFields("Teksti45").Result = modifiedValueD32
    
    ' Get the value from cell D1 in Excel
    valueD1 = excelWorksheet.Range("D1").Value
    
    ' Trim the value from cell D1 and remove the Euro symbol
    modifiedValueD1 = Trim(Replace(valueD1, "€", ""))
    
    ' Fill the "Teksti48" field in Word with the modified value from D1
    ActiveDocument.FormFields("Teksti48").Result = modifiedValueD1
    
    ' Get the values from cells D50, D60, and D64 in Excel
    valueD50 = excelWorksheet.Range("D50").Value
    valueD60 = excelWorksheet.Range("D60").Value
    valueD64 = excelWorksheet.Range("D64").Value
    
    ' Calculate the sum of the three values
    sumValue = valueD50 + valueD60 + valueD64
    
    ' Fill the "Teksti46" field in Word with the calculated sum
    ActiveDocument.FormFields("Teksti46").Result = sumValue
    
    ' Clean up objects
    Set excelWorksheet = Nothing
    Set excelWorkbook = Nothing
    Set excelApp = Nothing
End Sub
