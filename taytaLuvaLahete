Sub taytaLuvaLahete()
    On Error GoTo ErrorHandler
    
    Dim excelApp As Object ' Excel.Application
    Dim excelWorkbook As Object ' Excel.Workbook
    Dim excelSheet As Object ' Excel.Worksheet
    Dim wordApp As Object ' Word.Application
    Dim wordDoc As Object ' Word.Document
    
    ' Set the Excel application and workbook
    Set excelApp = GetObject(, "Excel.Application")
    Set excelWorkbook = excelApp.Workbooks("Hankkeet makroilla2.xls")
    Set excelSheet = excelWorkbook.Sheets("Main")
    
    ' Set the Word application and document
    Set wordApp = GetObject(, "Word.Application")
    Set wordDoc = wordApp.Documents("Luva-lähete Skannaukseen.docm")
    
    ' Fill the Word document fields with Excel cell values
    wordDoc.FormFields("Teksti3").Result = excelSheet.Range("C6").Value
    wordDoc.FormFields("Text2").Result = excelSheet.Range("D13").Value
    wordDoc.FormFields("Teksti5").Result = excelSheet.Range("F2").Value
    wordDoc.FormFields("Hankenumero").Result = excelSheet.Range("B40").Value
    wordDoc.FormFields("Nimi1").Result = excelSheet.Range("B44").Value & vbCrLf & excelSheet.Range("B47").Value & vbCrLf & excelSheet.Range("B50").Value
    wordDoc.FormFields("Sotu1").Result = excelSheet.Range("B45").Value & vbCrLf & excelSheet.Range("B48").Value & vbCrLf & excelSheet.Range("B51").Value
    
    ' Find the cell starting with "Lisätietoja Myyntitehtävälle:" in Excel
    Dim additionalInfoCell As Object
    Set additionalInfoCell = excelSheet.Range("A7:B39").Find("Lisätietoja Myyntitehtävälle:", LookIn:=xlValues)
    
    ' If the cell is found, fill the corresponding field in Word
    If Not additionalInfoCell Is Nothing Then
        Dim additionalInfo As String
        additionalInfo = additionalInfoCell.Offset(1).Value
        Do Until additionalInfoCell.Offset(1).Row = 40 Or additionalInfoCell.Offset(1).Value = ""
            Set additionalInfoCell = additionalInfoCell.Offset(1)
            additionalInfo = additionalInfo & vbCrLf & additionalInfoCell.Value
        Loop
        wordDoc.FormFields("Teksti8").Result = additionalInfo
    End If
    
    ' Find the cells starting with "pura" in Excel
    Dim puraRange As Object
    Set puraRange = excelSheet.Range("A89:C125")
    
    ' Iterate through the cells and fill the corresponding field in Word
    Dim puraCell As Object
    Dim puraInfo As String
    puraInfo = ""
    For Each puraCell In puraRange
        If Left(puraCell.Value, 4) = "pura" Then
            puraInfo = puraInfo & puraCell.Value & vbCrLf
        End If
    Next puraCell
    
    ' If there is any "pura" info, fill the corresponding field in Word
    If puraInfo <> "" Then
        wordDoc.FormFields("Teksti8").Result = wordDoc.FormFields("Teksti8").Result & vbCrLf & puraInfo
    End If
    
    ' Display a message indicating successful filling of fields
    MsgBox "Kentät täytetty onnistuneesti.", vbInformation, "Tiedot täytetty"
    
    Exit Sub
    
ErrorHandler:
    MsgBox "Virhe: " & Err.Description, vbCritical, "Virhe täytettäessä Word-dokumenttia"
End Sub
