Sub UpdateDataFromPDF()
    Dim pdfText As String
    Dim luototussuhde As String
    Dim luototussuhdeValue As String
    Dim rpSheet As Worksheet
    Dim mainSheet As Worksheet
    Dim startCell As Range
    
    ' Set the worksheet variables
    Set rpSheet = ThisWorkbook.Sheets("rp")
    Set mainSheet = ThisWorkbook.Sheets("Main")
    
    ' Prompt the user to copy the contents of the PDF file
    MsgBox "Please copy the entire text content of the PDF file and click OK when ready."
    
    ' Clear the entire "rp" sheet
    rpSheet.Cells.Clear
    
    ' Retrieve the copied text from the clipboard
    pdfText = GetClipboardText()
    
    ' Specify the starting cell for inserting the PDF text (change A1 to the desired cell reference)
    Set startCell = rpSheet.Range("A1")
    
    ' Split the text into lines
    Dim lines As Variant
    lines = Split(pdfText, vbNewLine)
    
    ' Insert each line of the text into consecutive cells in column A
    Dim i As Long
    For i = 0 To UBound(lines)
        startCell.Offset(i, 0).Value = lines(i)
    Next i
    
    ' Find the luototussuhde value between "Ratkaisuehdotus" and "Vakuudet yhteensä"
    luototussuhde = FindTextBetween(pdfText, "Ratkaisuehdotus", "Vakuudet yhteensä")
    
    ' Check if luototussuhde value exists
    If luototussuhde <> "" Then
        ' Extract the number from the luototussuhde string
        luototussuhdeValue = ExtractNumberFromString(luototussuhde)
        
        ' Update cell B82 in the "Main" sheet with luototussuhde value
        mainSheet.Range("B82").Value = "Luototussuhde " & luototussuhdeValue & " %"
    End If
End Sub

Function GetClipboardText() As String
    Dim dataObj As MSForms.DataObject
    
    Set dataObj = New MSForms.DataObject
    dataObj.GetFromClipboard
    GetClipboardText = dataObj.GetText
End Function

Function FindTextBetween(sourceText As String, startText As String, endText As String) As String
    Dim startPos As Long
    Dim endPos As Long
    
    startPos = InStr(sourceText, startText)
    If startPos > 0 Then
        startPos = startPos + Len(startText)
        endPos = InStr(startPos, sourceText, endText)
        If endPos > startPos Then
            FindTextBetween = Trim(Mid(sourceText, startPos, endPos - startPos))
        End If
    End If
End Function

Function ExtractNumberFromString(sourceText As String) As String
    Dim numStr As String
    Dim i As Integer
    
    numStr = ""
    For i = 1 To Len(sourceText)
        If IsNumeric(Mid(sourceText, i, 1)) Or Mid(sourceText, i, 1) = "," Then
            numStr = numStr & Mid(sourceText, i, 1)
        End If
    Next i
    
    ExtractNumberFromString = numStr
End Function
