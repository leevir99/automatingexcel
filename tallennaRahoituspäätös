Sub tallennaRahoituspaatos()
    Dim savePath As String
    Dim fileName As String
    Dim hankenumero As String
    
    ' Check if hankenumero is empty
    hankenumero = Range("B40").Value
    If Len(hankenumero) = 0 Then
        MsgBox "Hankenumero puuttuu solusta B40", vbExclamation, "Virhe"
        Exit Sub
    End If
    
    ' Ask the user to activate the desired PDF
    MsgBox "Aseta PDF-XChange Editor -ohjelmassa rahoituspäätös aktiiviseksi/näkyville ja paina sen jälkeen OK.", vbInformation, "Ohje"
    
    ' Set the save path and file name
    savePath = Range("E28").Value
    fileName = "Rahoituspäätös"
    
    ' Save the active document as PDF
    On Error Resume Next
    With CreateObject("Shell.Application")
        .Windows.Find("PDF-XChange Editor").Document.ExportAsFixedFormat 0, savePath & "\" & fileName & ".pdf"
    End With
    On Error GoTo 0
    
    ' Check if the save operation was successful
    If Dir(savePath & "\" & fileName & ".pdf") <> "" Then
        ' Display a success message
        MsgBox "PDF tallennettu onnistuneesti.", vbInformation, "Tallennus"
    Else
        ' Display an error message
        MsgBox "Virhe tallennettaessa PDF:ää.", vbExclamation, "Virhe"
    End If
End Sub

