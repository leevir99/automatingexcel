function DoHighlight() {
  var regex = /Luototussuhde \d+(,\d+)? %/g;  // Updated regular expression pattern
  var nTotal = 0;

  for (var p = 0; p < this.numPages; p++) {
    var words = this.getPageNumWords(p);
    var pageText = '';

    for (var w = 0; w < words; w++) {
      pageText += this.getPageNthWord(p, w) + ' ';
    }

    var matches;
    while ((matches = regex.exec(pageText)) !== null) {
      var matchText = matches[0];
      var startIndex = matches.index;
      var endIndex = startIndex + matchText.length;

      // Adjust endIndex to exclude special characters
      if (matchText.endsWith('%')) {
        endIndex--;
      }

      this.addAnnot({
        page: p,
        type: "Highlight",
        quads: this.getPageNthWordQuads(p, startIndex),
      });
      nTotal++;
    }
  }

  return nTotal;
}

var t = DoHighlight();
console.println(t + " occurrences were highlighted");
